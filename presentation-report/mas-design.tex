\section{Multi-Agent System Design}

\begin{frame}{Multi-Agent System Design: Overview}
    \begin{itemize}
        \item Agents
            \begin{itemize}
                \item Robot Agent for each robot
                \item Resource Agent for each node on city graph
            \end{itemize}

        \item Ant-based Delegate MAS
            \begin{itemize}
                \item Ants sent out by robots
                \item Desire Ants
                \begin{itemize}
                    \item Find delivery tasks
                \end{itemize}

                \item Exploration Ants
                \begin{itemize}
                    \item Explore possible paths towards destinations
                \end{itemize}

                \item Intention Ants
                \begin{itemize}
                    \item Choose path and create reservation
                \end{itemize}
            \end{itemize}

        \item Buildings
            \begin{itemize}
                \item 1 Pizzeria
                \item 1 Charging Station
                \item Random Road Works
            \end{itemize}
    \end{itemize}
\end{frame}

\begin{frame}{Multi-Agent System Design: Ants}
    \begin{itemize}
        \item Ants travel to destinations through resource agents
        \item Follow paths generated by robots (using their static maps)
        \item Are sent to next resource agents at every simulation tick
    \end{itemize}

    \begin{itemize}
        \item \textbf{Desire ants}: sent to all delivery tasks in the city and gather information about each task (amount of pizzas left, waiting time, estimated travel time).
        \item \textbf{Exploration ants}: estimate travel time for paths (accounting for road works) and get amount of pizzas left in case it changed since desire ant
        \item \textbf{Intention ants}: create reservations (with expiration times) for deliveries with possibly multiple destinations and confirm the intentions of robots
    \end{itemize}
\end{frame}

\begin{frame}[allowframebreaks]{Multi-Agent System Design: Robot Strategy}
    \begin{itemize}
        \item Simplified version of strategy to fit presentation in time slot
        \item[]

        \item Robot strategy loop:
        \begin{enumerate}
            \item Read all new messages (ants)
            \item Process ants if all ants of a type have returned
            \item Reconsider intentions if not waiting for ants
            \item Resend exploration or intention ants if respective timer has passed
            \item Do action if intention is present, not charging, and not waiting for ants
        \end{enumerate}

        \item Will explain 2, 3, and 5 in more detail

        \framebreak

        \item 2.A) Process desire ants if all have returned:
        \begin{itemize}
            \item (Desire ants contain information about waiting delivery tasks)
            \item Select as many tasks as the robot can handle at once
            \item Select tasks using fitness proportionate selection where fitness is waiting time
            \item Send exploration ants along alternative paths that visit all selected tasks
            \item Alternative paths are found using static map and A* with penalty for common nodes on paths~\cite{alternativePaths}
        \end{itemize}

        \framebreak
        \item 2.B) Process exploration ants if all have returned:
        \begin{itemize}
            \item (Exploration ants contain travel time for the path they traveled)
            \item Select the path with the lowest estimated travel time
            \item If there is a current intention and current estimated travel time left is lower than new estimated time, then stop here
            \item If intended destination is pizzeria, set intention to selected path
            \item Else send intention ant along this path
        \end{itemize}

        \item[]
        \item 2.C) Process intention ant if returned:
        \begin{itemize}
            \item If want to go to charging station, set intention to path of ant
            \item Else (want to go to delivery destinations):
            \begin{itemize}
                \item If not carrying pizzas, get pizzas from pizzeria
                \item Set intention to path of ant
            \end{itemize}
        \end{itemize}

        \framebreak

        \item 5) Do action if intention is present, not charging, and not waiting for ants:
        \begin{itemize}
            \item Move along the current intention
            \item If currently at a delivery task destination, deliver pizzas
            \item If was going charging station and arrived, then set up for charging
            \item If was going to pizzeria and arrived, then set up for new delivery tasks
            \item If last node on intention was reached, remove it so that intention reconsideration can find a new one
        \end{itemize}

        \framebreak

        \item 3) Reconsider intentions if not waiting for ants:
        \begin{itemize}
            \item If intention is present, but no connection exists to next node on path, delete the intention

            \item If no intention is present
            \begin{itemize}
                \item If going to charge, explore paths towards charging station
                \item If carrying pizzas for delivery tasks, explore paths for the tasks
                \item If at pizzeria, get waiting delivery tasks from pizzeria and send desire ants
                \item If not at pizzeria, not charging, and not going to charge, then explore paths towards pizzeria (to get new tasks)
            \end{itemize}

            \item Else (intention is present, but check if it should be replaced by a more important one)
            \begin{itemize}
                \item If battery is low, delete current intention (keep any pizzas being carried) and explore paths towards charging station
            \end{itemize}

            % If robot is doing a delivery, but the battery becomes low, it will delete the current intention and go to charge
            % Once arrived at the charging station, this step will go into the "if no intention present", and will explore
            % paths for the pizzas it is carrying, after it is done charging, it will move along its new intention
            % Intention ants can also be sent during charing for refreshing reservations
        \end{itemize}
    \end{itemize}
\end{frame}

